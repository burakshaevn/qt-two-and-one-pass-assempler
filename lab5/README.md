# Однопросмотровый ассемблер для перемещаемых программ

Программа реализует однопросмотровый ассемблер для перемещаемых программ на C++/Qt. Ассемблер поддерживает различные режимы адресации и генерирует объектный код в формате с записями H, T, M и E.

## Пример
| Прямая адресация | Смешанный случай |
|--------------|--------|
| <img width="1188" height="877" alt="image" src="https://github.com/user-attachments/assets/7461eff5-cf42-4a23-aa8e-58ee80298b82" /> | <img width="1188" height="877" alt="image" src="https://github.com/user-attachments/assets/0017b3f5-cb08-4843-9715-9e28b15e2f7e" /> |
| Рис. 1 | Рис. 2 |

## Что такое перемещаемые программы

Это программы, которые могут быть загружены и выполнены по любому адресу в памяти, а не только по фиксированному адресу. Это достигается за счет:

- **Относительной адресации** — использование относительных смещений вместо абсолютных адресов позволяет программе работать независимо от адреса загрузки
- **Таблицы настройки (ТН)** — содержит список адресов в объектном коде, которые необходимо изменить при загрузке программы по новому адресу
- **Записей модификации (M)** — указывают загрузчику, какие байты в объектном коде нужно модифицировать при перемещении программы

При загрузке программы загрузчик использует записи M для настройки адресов в соответствии с новым адресом загрузки, что позволяет программе корректно работать независимо от того, по какому адресу она была загружена.

## Требования

- Qt 5+ (тогда в CMake нужно поменять Qt6 на Qt5)
- CMake 3.16 или выше
- C++17 совместимый компилятор (GCC, Clang, MSVC)

## Сборка

```bash
mkdir build
cd build
cmake ..
cmake --build .
```

Или Qt Creator → Open project → CMakeLists.txt → Configure

## Запуск

После сборки выполните:

```bash
./Assembler
```

или на Windows:

```bash
.\Assembler.exe
```

## Использование

1. **Выбор режима адресации** - используйте выпадающий список для выбора одного из режимов:
   - **Прямая адресация** - использование прямых меток (например, `LOADR1 B1`)
   - **Относительная адресация** - использование относительных меток в квадратных скобках (например, `LOADR1 [B1]`)
   - **Смешанный вариант** - комбинация прямой и относительной адресации

2. **Исходный код** - введите исходный код ассемблера в левое верхнее поле. Программа должна начинаться с директивы `START` с меткой и адресом загрузки 0 (например, `PROG  START   0`)

3. **Таблица кодов операций** - введите таблицу кодов операций в левое нижнее поле в формате:
   ```
   ИМЯ_КОМАНДЫ КОД ДЛИНА
   ```
   Например:
   ```
   JMP 1 4
   LOADR1 2 4
   ADD 4 2
   ```

4. **Кнопки управления**:
   - **Шаг** - выполнить один шаг ассемблирования
   - **Выполнить полный проход** - выполнить полную ассембляцию за один раз
   - **Сброс** - сбросить состояние ассемблера и начать заново

## Результаты

Результаты отображаются в правых полях:

- **Двоичный код** - объектный код в формате с записями:
  - `H` - заголовок программы (имя программы, адрес загрузки, длина)
  - `T` - текстовые записи (адрес, длина, данные)
  - `M` - записи модификации из таблицы настройки
  - `E` - запись окончания (адрес входа)

- **Таблица символических имен (ТСИ)** - таблица меток с их адресами и требованиями адресации

- **Таблица настройки (ТН)** - список адресов, требующих настройки при загрузке

- **Ошибки** - сообщения об ошибках ассемблирования (если есть)

## Поддерживаемые директивы

- `START` - начало программы (должна быть первой строкой с меткой и адресом 0)
- `END` - конец программы (может содержать адрес входа)
- `WORD` - резервирование слова (3 байта)
- `BYTE` - резервирование байта или строки (C"..." или X"...")
- `RESW` - резервирование слов (1-85 слов)
- `RESB` - резервирование байтов (1-255 байт)

## Формат команд

Команды могут иметь различную длину:
- **Длина 1** - команды без операндов
- **Длина 2** - команды с одним байтовым операндом или двумя регистрами
- **Длина 4** - команды с адресным операндом (прямая или относительная адресация)

## Структура проекта

- `assembler/` - логика ассемблера (класс Assembler и связанные структуры)
- `helpers/` - вспомогательные классы (Parser для разбора кода, Comparer для сравнения)
- `MainWindow.*` - главное окно приложения с интерфейсом
- `main.cpp` - точка входа в программу

